{% load staticfiles %}

<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
			<title>My first Three.js app</title>
			<style>
				body { margin: 0; }
				canvas { width: 100%; height: 100% }
			</style>
	</head>
	<body>

		<div id="countdown"> </div>
		<div id="timeout">Time out!</div>

		<script src="{% static 'gnovel/js/third_party/three.min.js' %}"></script>
		<script>
			// Our Javascript will go here.

			//Display images
			var camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 10000 );
			camera.position.z = 900;

			var scene = new THREE.Scene();
			var renderer = new THREE.WebGLRenderer();
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

			var material, quad;

			var texture = THREE.ImageUtils.loadTexture("{% static 'gnovel/res/textures/testpic.png'%}");
			texture.minFilter = THREE.LinearFilter;
			texture.magFilter = THREE.NearestFilter;

			material = new THREE.MeshBasicMaterial({ color: 0xffffff, map: texture });

			var plane = new THREE.PlaneBufferGeometry( 512, 768 );

			quad = new THREE.Mesh( plane, material );
			quad.position.z = -100;
			scene.add( quad );

			var render = function () {
				requestAnimationFrame( render );
				renderer.render(scene, camera);
			};

			render();

			//Countdown timer

			window.onload = function() {
			    var countdownElement = document.getElementById('countdown'),
			        timeoutarea = document.getElementById('timeout'),
			        seconds = 10,
			        second = 0,
			        interval;

			    timeoutarea.style.display = 'none';

			    interval = setInterval(function() {
			        countdownElement.firstChild.data = 'You have ' + (seconds - second) + ' seconds to make your decision.';
			        if (second >= seconds) {
			            timeoutarea.style.display = 'block';
			            clearInterval(interval);
			        }

			        second++;
			    }, 1000);
			}
			
		</script>
		
		{{ text }}
	</body>
</html>